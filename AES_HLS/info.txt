For an up to date version of this code visit https://github.com/hplp/AES_code